# 匠度測定システム - Takumi Measurement System

マウス描画タスク、顔認識、ストレス反応を通じて、あなたの「匠度」（職人レベル）を60秒で評価する精密測定システムです。

## 機能

- **60秒の総合テスト** - 精密さ、落ち着き、器用さを測定
- **リアルタイム顔認識** - face-api.jsを使用した呼吸と表情のモニタリング
- **円描画タスク** - 手の精密さと安定性を測定
- **ストレステスト段階** - 視覚的・聴覚的刺激によるテスト
- **回復評価** - ストレス耐性の評価
- **匠度スコア計算** - CからSSSまでのランク評価
- **運転適性評価** - 総合的なパフォーマンスに基づく評価
- **かわいい猫のキャラクター** - ガイダンスと励ましを提供

## インストール

1. リポジトリをクローン
2. インストールスクリプトを実行：
   ```bash
   cd takumi-measurement
   ./scripts/install.sh
   ```

3. 必要なアセットを追加：
   - バックグラウンドミュージック：`sound/backmusic.mp3`
   - （オプション）`image/`ディレクトリ内のプレースホルダー画像を置き換え

## システムの実行

```bash
node js/setup-https.js
```

その後、ブラウザを開いて以下にアクセス：https://localhost:8443

**注意：** 証明書の警告が表示されます。これは自己署名証明書の場合は正常です。「詳細設定」をクリックして「localhost（安全ではありません）にアクセス」を選択して続行してください。

## テストシーケンス

1. **0-10秒：初期校正**
   - カメラとマイクの初期化
   - ベースライン用の5回の呼吸サイクル
   - 表情のベースライン取得

2. **10-25秒：円描画**
   - ガイドに従って円を描く
   - 精密さ、滑らかさ、手の安定性を測定

3. **25-45秒：ストレステスト**
   - イライラする視覚刺激が表示される
   - バックグラウンドミュージックのテンポと音量が上昇
   - ストレス下で描画を継続

4. **45-60秒：回復評価**
   - ストレス刺激を除去
   - 回復速度を測定
   - 最終スコアの計算

## スコアリングシステム

- **精密さ（40%）**：円の正確性、滑らかさ、完成度
- **落ち着き（30%）**：呼吸の安定性、表情の落ち着き、ストレス耐性
- **器用さ（30%）**：速度の一貫性、手の安定性、回復速度

### ランク
- **SSS**：96-100（伝説の職人）
- **S**：86-95（マスターレベル）
- **A**：71-85（優秀）
- **B**：41-70（良好）
- **C**：0-40（練習が必要）

## 必要条件

- Node.js 16以上
- WebRTCをサポートする最新のブラウザ
- ウェブカメラとマイクの権限
- HTTPS接続（自己署名証明書により提供）

## トラブルシューティング

- **カメラが動作しない**：HTTPSアクセスとカメラ権限が許可されていることを確認
- **音が出ない**：音声再生を有効にするためにページ内のどこかをクリック
- **face-apiエラー**：モデルファイルをダウンロードするためにインストールスクリプトを実行
- **証明書エラー**：ブラウザで自己署名証明書を受け入れる

## ライセンス

このプロジェクトはデモンストレーションおよび教育目的のためのものです。