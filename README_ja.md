# 匠度測定システム - Takumi Measurement System

60秒間の精密動作測定を通じて、あなたの「匠度」（職人レベル）をマウス描画タスク、顔分析、ストレス反応から評価するシステムです。

## 機能

- **60秒間の総合テスト** - 精密さ、落ち着き、器用さを測定
- **リアルタイム顔分析** - face-api.jsを使用した呼吸と表情のモニタリング
- **円描画タスク** - 手の精密さと安定性を測定
- **ストレステストフェーズ** - 視覚的・聴覚的刺激によるストレス耐性評価
- **回復力評価** - ストレスからの回復速度を評価
- **匠スコア算出** - CからSSSまでのランク判定
- **運転適性評価** - 総合的なパフォーマンスに基づく判定
- **かわいい猫のキャラクター** - ガイダンスと励ましを提供

## インストール

1. リポジトリをクローン
2. インストールスクリプトを実行:
   ```bash
   cd takumi-measurement
   ./scripts/install.sh
   ```

3. 必要なアセットを追加:
   - BGM: `sound/backmusic.mp3`
   - (オプション) `image/` ディレクトリ内のプレースホルダー画像を置き換え

## システムの実行

```bash
node js/setup-https.js
```

ブラウザで以下のURLにアクセス: https://localhost:8443

**注意:** 証明書の警告が表示されます。これは自己署名証明書では正常です。「詳細設定」をクリックし、「localhost にアクセスする」を選択してください。

## テストシーケンス

1. **0-10秒: 初期校正**
   - カメラとマイクの初期化
   - 基準となる5回の呼吸サイクル
   - 表情のベースライン取得

2. **10-25秒: 円描画**
   - ガイドに従って円を描く
   - 精密さ、滑らかさ、手の安定性を測定

3. **25-45秒: ストレステスト**
   - 刺激的な視覚効果が表示
   - BGMのテンポと音量が上昇
   - ストレス下での描画継続

4. **45-60秒: 回復評価**
   - ストレス刺激の解除
   - 回復速度の測定
   - 最終スコアの算出

## スコアリングシステム

- **精密さ (40%)**: 円の正確さ、滑らかさ、完成度
- **落ち着き (30%)**: 呼吸の安定性、表情の平静さ、ストレス耐性
- **器用さ (30%)**: 速度の一貫性、手の安定性、回復速度

### ランク
- **SSS**: 96-100 (伝説の匠)
- **S**: 86-95 (マスターレベル)
- **A**: 71-85 (優秀)
- **B**: 41-70 (良好)
- **C**: 0-40 (要練習)

## 必要要件

- Node.js 16以上
- WebRTC対応の最新ブラウザ
- ウェブカメラとマイクの権限
- HTTPS接続（自己署名証明書により提供）

## トラブルシューティング

- **カメラが動作しない**: HTTPSアクセスとカメラ権限が許可されているか確認
- **音が出ない**: ページ内をクリックして音声再生を有効化
- **face-apiエラー**: インストールスクリプトを実行してモデルファイルをダウンロード
- **証明書エラー**: ブラウザで自己署名証明書を承認

## ライセンス

このプロジェクトはデモンストレーションおよび教育目的で作成されています。